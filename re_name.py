import chardet

"""
import re
import sys

def replace_names_in_file(file_path, name_mapping):
    # 读取文件内容
    with open(file_path, 'r', encoding='utf-8') as file:
        content = file.read()
    
    # 构建正则表达式，匹配目标人名
    pattern = r'(' + '|'.join(map(re.escape, name_mapping.keys())) + ')'
    
    # 替换人名
    def replace(match):
        return name_mapping[match.group(0)]  # 返回对应的新名称

    new_content = re.sub(pattern, replace, content)
    
    # 将替换后的内容写回文件
    with open(file_path, 'w', encoding='utf-8') as file:
        file.write(new_content)

if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("请提供要处理的文件名。")
        sys.exit(1)

    file_path = sys.argv[1]  # 从命令行参数获取文件路径
    
    # 使用字典定义人名映射
    name_mapping = {
        '刘一菲': '刘亦菲',
        '刘亦非': '刘亦菲',
        '杨密': '杨幂',
        '杨蜜': '杨幂',
        '唐烟': '唐嫣',
        '唐妍': '唐嫣',
        '唐燕': '唐嫣'
        # 可以继续添加更多的人名映射
    }

    replace_names_in_file(file_path, name_mapping)
    print("人名替换完成。")

"""

import re
import sys

def replace_names_in_file(file_path):

    # 定义替换规则
    replacements = {
        r'白(?:璐|露)': '白鹿',
        r'白(?:彬|兵|宾)': '白冰',
        r'寶镪': '宝强',
        r'笔辰': '碧晨',
        r'笔晨': '碧晨',
        r'(?:彬彬姐|宾宾姐|兵兵姐|水水姐)': '冰冰姐',
        r'朝哥': '超哥',
        r'陈(?:道铭|导明|道鸣)': '陈道明',
        r'陈(?:贺|赤赤)': '陈赫',
        r'陈恏': '陈好',
        r'(?:程|陈)(?:恺|楷|铠|凯)(?:歌|哥|鸽|戈|各)': '陈凯歌',
        r'陈昆': '陈坤',
        r'程瑶': '陈瑶',
        r'陈(?:子涵)': '陈紫函',
        r'陈(?:奕训)': '陈奕迅',
        r'陈(?:关西)': '陈冠希',
        r'陈(?:可莘)': '陈可辛',
        r'(?:程|成|陈|郕|诚|乘)(?:龙|隆|笼|陇)': '成龙',
        r'程萧': '程潇',
        r'朝越': '超越',
        r'大章伟': '大张伟',
        r'邓(?:潮|朝|嘲)': '邓超',
        r'邓(?:子琪|子其|子棋|梓琪)': '邓紫棋',
        r'董(?:萱|旋|炫|漩|宣)': '董璇',
        r'董(?:青|清)': '董卿',
        r'(?:迪俪|迪立|笛俪)': '迪丽',
        r'热(?:芭|吧)': '热巴',
        r'范(?:彬彬|兵兵|宾宾|水水|二冰|氷氷)': '范冰冰',
        r'冯恭': '冯巩',
        r'冯(?:小|晓|)(?:钢|刚)': '冯小刚',
        r'马大缸': '冯小刚',
        r'马思存': '马思纯',
        r'高(?:媛媛|缘缘|元元|源源)': '高圆圆',
        r'葛(?:游|友)': '葛优',
        r'(龚莉|巩莉|巩利|巩丽)': '巩俐',
        r'古力扎扎': '古力娜扎',
        r'关小彤': '关晓彤',
        r'关徔琳': '关之琳',
        r'(?:韩|寒)(?:山|三|叁)(?:屏|平|屏|坪|品|瓶|评)': '韩三平',
        r'(?:韩|寒)(?:樰|膤|雪)': '韩雪',
        r'何(?:炯|囧)': '何炅',
        r'胡(?:戈|鸽|哥|葛)': '胡歌',
        r'(?:化|花)(?:成雨|雨辰)': '华晨宇',
        r'黄(?:波|博|勃)': '黄渤',
        r'黄(?:雷|垒|擂)': '黄磊',
        r'黄(?:达岸|小铭|晓名|小名)': '黄晓明',
        r'黄晟依': '黄圣依',
        r'贾(?:净雯|婧雯|菁雯|静文)': '贾静雯',
        r'金(?:辰|尘)': '金晨',
        r'金(?:成吾)': '金城武',
        r'姜(?:闻|温|纹)': '姜文',
        r'蒋(?:芯|歆|昕)': '蒋欣',
        r'(?:景|井|京)(?:恬|甜|田|添|湉)': '景甜',
        r'景(?:哥)': '京哥',
        r'李(?:彬彬|兵兵|宾宾|水水|二冰|莲花|氷氷)': '李冰冰',
        r'李(?:炼|莲|联|连|联|链)(?:杰|界|结|接)': '李连杰',
        r'李(?:小|晓)(?:染|然|燃|苒|姌|冉)': '李小冉',
        r'李(?:晴|庆|清|箐)': '李沁',
        r'李(?:丝丝|司司)': '李思思',
        r'李(?:嘉辛|佳欣)': '李嘉欣',
        r'李(?:家航)': '李佳航',
        r'李(?:按|桉)': '李安',
        r'宁(?:敬|惊|境|晶)': '宁静',
        r'林(?:耿鑫|庚新)': '林更新',
        r'林(?:韵儿|昀儿)': '林允儿',
        r'刘(?:德桦|福荣|得化)': '刘德华',
        r'浏(?:浩燃|宪华)': '刘昊然',
        r'浏(?:宪华)': '刘宪华',
        r'浏(?:楷崴)': '刘恺威',
        r'刘(?:佳玲)': '刘嘉玲',
        r'(?:刘|柳)(?:师师|施施|丝丝|思思|司司|诗丝|小诗)': '刘诗诗',
        r'刘(淘|韬)': '刘涛',
        r'柳阿姨': '刘阿姨',
        r'柳茜': '刘亦菲',
        r'冷巴': '热巴',
        r'丽影': '丽颖',
        r'(?:刘|柳)(?:茜茜|亦菲|一非|一菲|依霏|逸妃|亦非|亦妃|艺妃|伊菲|依菲|艺菲|一霏|奕霏)': '刘亦菲',
        r'柳(?:颜|研|燕|妍)': '柳岩',
        r'卢(?:靖杉)': '卢靖姗',
        r'梁(?:超卫)': '梁朝伟',
        r'(?:陆|路|卢)(?:洋|阳|羊|扬)': '路阳',
        r'(马|鹿|路|陆)(?:涵|晗|寒|瀚|韩)': '鹿晗',
        r'孟(子亦|子艺|子意)': '孟子义',
        r'(密|蜜|咪)(?:姐)': '幂姐',
        r'(((?<!甜)蜜蜜|(?<!小)密密)|宓宓)': '幂幂',
        r'(?:娜|那|纳)(?:札|扎|轧|楂)': '娜扎',
        r'奈(?:子)': '奶子',
        r'倪(?:尼|霓)': '倪妮',
        r'潘(?:月明|越明)': '潘粤明',
        r'奇林': '麒麟',
        r'齐薇': '戚薇',
        r'乔(?:镇羽|震雨)': '乔振宇',
        r'秦(?:蓝|澜|兰)': '秦岚',
        r'撒(?:钡宁|贝柠)': '撒贝宁',
        r'涩狼': '色狼',
        r'沈(?:滕|疼|藤|誊)': '沈腾',
        r'(?:师师|施施|思思|司司)': '诗诗',
        r'石小龙': '释小龙',
        r'(?:苏|舒|畅)(?:唱|常|畅|倡)': '舒畅',
        r'(?:书影|淑影)': '疏影',
        r'宋(?:西|倩)': '宋茜',
        r'宋(?:佚|铁|怡|艺)': '宋轶',
        r'(?:颂|宋)(?:组|组|族|祖)(?:唲|儿|娥|迩|洱)': '宋祖儿',
        r'孙(?:宏|红|洪)(?:垒|磊)': '孙红雷',
        r'孙(?:亦)': '孙怡',
        r'(汤|糖|唐)(?:烟|妍|燕|嫣|鄢|颜)': '唐嫣',
        r'(?:佟|童)(?:大丫|丽丫|丽亚|莉雅|俐雅|俐丫)': '佟丽雅',
        r'唐艺(?:欣|心)': '唐艺昕',
        r'汤(?:为|帷)': '汤唯',
        r'恬恬': '甜甜',
        r'王(宝|保)(?:镪|墙|襁|强)': '王宝强',
        r'王顺溜': '王宝强',
        r'王祖娴': '王祖贤',
        r'王(?:妃|非|霏)': '王菲',
        r'王(?:赫第)': '王鹤棣',
        r'王(?:菁|金|景|精|晶|惊)(?!花|华|椛)': '王晶',
        r'王(?:菁|金|景|精|晶|惊)(?:花|华|椛)': '王京花',
        r'王(?:利琨|莉坤)': '王丽坤',
        r'王(?:佳位|家位)': '王家卫',
        r'王(?:撕葱)': '王思聪',
        r'王(?:智|芝|枝|致|稚)': '王志',
        r'温戏': '吻戏',
        r'吴(?:景|惊|晶|经|晾|金|精)': '吴京',
        r'小明': '晓明',
        r'许情': '许晴',
        r'(?:西西|曦曦)': '茜茜',
        r'谢(?:听风|霆峰|挺峰|廷风)': '谢霆锋',
        r'薛知谦': '薛之谦',
        r'徐菁蕾': '徐静蕾',
        r'(?:严|颜)丹(?:辰|宸)': '颜丹晨',
        r'(?:杨|羊)(?:超|朝)(?:越|悦|月)': '杨超越',
        r'(杨)(?:笛)': '杨迪',
        r'(杨|阳|羊)(?:羊)': '杨阳',
        r'(?:杨|羊|楊)(?:密|蜜|咪|小蜜|谧|宓)': '杨幂',
        r'杨梓': '杨紫',
        r'杨昆': '杨坤',
        r'杨影': '杨颖',
        r'杨容': '杨蓉',
        r'杨樰': '杨雪',
        r'(?:一菲|亦非|伊菲|依菲|亦妃|艺菲|逸妃|艺妃|一非|一霏|奕霏)': '亦菲',
        r'媛媛': '圆圆',
        r'(?:俞|于)(?:绯|菲|妃|飞|霏)(?:红|虹|鸿|虹)': '俞飞鸿',
        r'张(?:白|柏|博|栢|柏)(?:纸|之|芝|字)': '张柏芝',
        r'(?:张|章|障)(?:壁|璧|蔽)(?:晨|尘|辰|橙|茞)': '张碧晨',
        r'(?:张|章)(?:壁晨|璧晨|壁尘|壁辰|壁橙|璧尘|璧辰|璧橙)': '张碧晨',
        r'张(?:果立|国利|国笠)': '张国立',
        r'(?:张|章)国威': '张国伟',
        r'(?:张|章)(?:纪中|纪忠|纪钟)': '张纪中',
        r'张(?:亮影|梁颖)': '张靓颖',
        r'张(?:若筠|若云)': '张若昀',
        r'张(?:雨琪|羽绮)': '张雨绮',
        r'章绍含': '张韶涵',
        r'(?:张|章)(?:天|添|甜)(?:艾|嫒|爱)': '张天爱',
        r'(?:张|章)(?:紫|梓|籽|姊)(?:淋|琳|霖|啉)': '张梓琳',
        r'(?:张|章)(?:国|果|帼)(?:绒|融|荣|容|栄|榮)': '张国荣',
        r'章一山': '张一山',
        r'(?:张|章)(?:亿|一|易|益|影)(?:某|谋|謀)': '张艺谋',
        r'(?:章|张)(?:亿|艺|一|易|益)(?:兴|星)': '张艺兴',
        r'(?:张|章)(?:子|紫|梓)(风|枫)': '张子枫',
        r'(?:张|章)(?:松|送|颂)(文|闻|纹|汶)': '张颂文',
        r'章(?:若南|若喃)': '章若楠',
        r'(?:张|章)(?:曼钰)': '张曼玉',
        r'(?:张|章)(?:紫怡|稀土|子义|紫怡|子怡|子意|紫衣)': '章子怡',
        r'赵(?:金麦|妗麦)': '赵今麦',
        r'赵(?:小|立|丽|莉)(?:盈|骨|颖|影|盈|赢)': '赵丽颖',
        r'赵(?:璐司|路思|璐思)': '赵露思',
        r'赵(?:奔山|本三)': '赵本山',
        r'赵微': '赵薇',
        r'周(?:瑞发|润法)': '周润发',
        r'周(?:冬与)': '周冬雨',
        r'周结(?:论|仑)': '周杰伦',
        r'周(?:星星|兴驰|睲池|兴池|星池)': '周星驰',
        r'周(?:熏|薰|讯|寻)': '周迅',
        r'周吔': '周也',
        r'郑霜': '郑爽',
        r'朱株': '朱珠',
        r'朱君': '朱军',
        r'子其': '紫棋',
        r'曾(?:梨|丽|莉|离|俐)': '曾黎',
        r'甄(?:子|紫|梓)(?:单|丹|弹|耽)': '甄子丹',
        r'(?:祖|组)(?:鹅|儿)': '祖儿'
    }

    encoding_used = 'utf-8'  # 默认使用 UTF-8 编码
    content = ''
    
    try:
        # 尝试使用 UTF-8 编码打开文件
        with open(file_path, 'r', encoding=encoding_used) as file:
            content = file.read()
    except UnicodeDecodeError:

        try:
            # 如果 UTF-8 编码失败，尝试使用 GBK 编码打开文件
            encoding_used = 'gbk'
            with open(file_path, 'r', encoding=encoding_used) as file:
                content = file.read()

        except UnicodeDecodeError:
            # 如果 GBK 编码失败，尝试使用 ansi 编码打开文件
            encoding_used = 'ansi'
            with open(file_path, 'r', encoding=encoding_used) as file:
                content = file.read()
    # 替换人名
    for pattern, new_name in replacements.items():
        content = re.sub(pattern, new_name, content)

    try:
        # 将替换后的内容写回文件，使用读取时成功的编码
        with open(file_path, 'w', encoding=encoding_used) as file:
            file.write(content)
    except IOError as e:
        # 如果写入文件时发生错误，打印错误信息
        print(f"Error writing to file: {e}")

if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("请提供要处理的文件名。")
        sys.exit(1)

    file_path = sys.argv[1]  # 从命令行参数获取文件路径

    replace_names_in_file(file_path)
    print("人名替换完成。")